{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u670d\u52a1\u6a21\u677f\u8bf4\u660e\u6587\u6863 \u670d\u52a1\u8bf4\u660e \u672c\u6587\u4ecb\u7ecd\u57fa\u4e8eMySQL\u8f6f\u4ef6\u5305\u5feb\u901f\u6784\u5efa\u6258\u7ba1\u7248\u5355\u79df\u6237\u8ba1\u7b97\u5de2\u670d\u52a1\uff0c\u5173\u4e8e\u8ba1\u7b97\u5de2\u6258\u7ba1\u7248\u53ef\u4ee5\u53c2\u8003 \u5e2e\u52a9\u6587\u6863 \uff0c \u672c\u793a\u4f8b\u91c7\u7528ECS+SLB\u7684\u67b6\u6784\uff0c\u9ed8\u8ba4\u652f\u6301\u79c1\u7f51\u6253\u901a\u3001\u7f51\u7edc\u53d8\u914d\u4e0e\u78c1\u76d8\u6269\u5bb9\u529f\u80fd\u3002\u7528\u6237\u90e8\u7f72\u670d\u52a1\u5b9e\u4f8b\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u5185\u7f51\u8bbf\u95ee\u90e8\u7f72\u5728\u670d\u52a1\u5546\u7684MySQL\uff0c\u9664\u6b64\u4e4b\u5916\u8fd8\u914d\u7f6e\u4e86\u4e09\u79cd\u5957\u9910\uff0c\u5206\u522b\u4e3a\uff1a \u5957\u9910\u540d SLB\u89c4\u683c ECS\u89c4\u683c\u65cf vCPU\u4e0e\u5185\u5b58 \u7cfb\u7edf\u76d8 \u516c\u7f51\u5e26\u5bbd \u4f4e\u914d\u7248 slb.s1.small ecs.c6.large \u5185\u5b58\u578bc6\uff0c2vCPU 4GiB ESSD\u4e91\u76d8 200GiB PL0 \u56fa\u5b9a\u5e26\u5bbd1Mbps \u57fa\u7840\u7248 slb.s1.small ecs.c6.xlarge \u5185\u5b58\u578bc6\uff0c4vCPU 8GiB ESSD\u4e91\u76d8 200GiB PL0 \u56fa\u5b9a\u5e26\u5bbd1Mbps \u9ad8\u914d\u7248 slb.s3.small ecs.c6.2xlarge \u5185\u5b58\u578bc6\uff0c4vCPU 8GiB ESSD\u4e91\u76d8 200GiB PL0 \u56fa\u5b9a\u5e26\u5bbd1Mbps \u672c\u793a\u4f8b\u5bf9\u5e94\u7684Git\u4ed3\u5e93\u5730\u5740\uff1a mysql-managed-demo \u672c\u793a\u4f8b\u4f1a\u81ea\u52a8\u7684\u6784\u5efa\u8ba1\u7b97\u5de2\u670d\u52a1\uff0c\u5177\u4f53\u7684\u670d\u52a1\u6784\u5efa\u6d41\u7a0b\u4e3a: \u5c06MySQL\u5b89\u88c5\u5305\uff08\u63d0\u524d\u5b58\u653e\u5230\u8be5github repo\u4e2d\uff09\u6784\u5efa\u4e3a\u8ba1\u7b97\u5de2\u6587\u4ef6\u90e8\u7f72\u7269 \u521b\u5efa\u8ba1\u7b97\u5de2\u670d\u52a1\u5e76\u5173\u8054\u6587\u4ef6\u90e8\u7f72\u7269 \u521b\u5efa\u8fc7\u7a0b\u5927\u7ea6\u6301\u7eed3\u5206\u949f\uff0c\u5f53\u670d\u52a1\u53d8\u6210\u5f85\u63d0\u4ea4\u540e\u6784\u5efa\u6210\u529f\u3002 \u90e8\u7f72\u67b6\u6784 \u672c\u90e8\u7f72\u67b6\u6784\u4e3aSLB+ECS\uff0c\u5b89\u5168\u7ec4\u5f00\u653e3306\u7aef\u53e3\uff0c\u5e76\u914d\u7f6e\u4e86\u7ec8\u7aef\u8282\u70b9\u3002 \u670d\u52a1\u6784\u5efa\u8ba1\u8d39\u8bf4\u660e \u6d4b\u8bd5\u672c\u670d\u52a1\u6784\u5efa\u65e0\u9700\u4efb\u4f55\u8d39\u7528\uff0c\u521b\u5efa\u670d\u52a1\u5b9e\u4f8b\u6d89\u53ca\u7684\u8d39\u7528\u53c2\u8003\u670d\u52a1\u5b9e\u4f8b\u8ba1\u8d39\u8bf4\u660e\u3002 RAM\u8d26\u53f7\u6240\u9700\u6743\u9650 \u672c\u670d\u52a1\u9700\u8981\u5bf9ECS\u3001VPC\u7b49\u8d44\u6e90\u8fdb\u884c\u8bbf\u95ee\u548c\u521b\u5efa\u64cd\u4f5c\uff0c\u82e5\u60a8\u4f7f\u7528RAM\u7528\u6237\u521b\u5efa\u670d\u52a1\u5b9e\u4f8b\uff0c\u9700\u8981\u5728\u521b\u5efa\u670d\u52a1\u5b9e\u4f8b\u524d\uff0c\u5bf9\u4f7f\u7528\u7684RAM\u7528\u6237\u7684\u8d26\u53f7\u6dfb\u52a0\u76f8\u5e94\u8d44\u6e90\u7684\u6743\u9650\u3002\u6dfb\u52a0RAM\u6743\u9650\u7684\u8be6\u7ec6\u64cd\u4f5c\uff0c\u8bf7\u53c2\u89c1 \u4e3aRAM\u7528\u6237\u6388\u6743 \u3002\u6240\u9700\u6743\u9650\u5982\u4e0b\u8868\u6240\u793a\u3002 \u6743\u9650\u7b56\u7565\u540d\u79f0 \u5907\u6ce8 AliyunECSFullAccess \u7ba1\u7406\u4e91\u670d\u52a1\u5668\u670d\u52a1\uff08ECS\uff09\u7684\u6743\u9650 AliyunVPCFullAccess \u7ba1\u7406\u4e13\u6709\u7f51\u7edc\uff08VPC\uff09\u7684\u6743\u9650 AliyunROSFullAccess \u7ba1\u7406\u8d44\u6e90\u7f16\u6392\u670d\u52a1\uff08ROS\uff09\u7684\u6743\u9650 AliyunComputeNestUserFullAccess \u7ba1\u7406\u8ba1\u7b97\u5de2\u670d\u52a1\uff08ComputeNest\uff09\u7684\u7528\u6237\u4fa7\u6743\u9650 AliyunComputeNestSupplierFullAccess \u7ba1\u7406\u8ba1\u7b97\u5de2\u670d\u52a1\uff08ComputeNest\uff09\u7684\u670d\u52a1\u5546\u4fa7\u6743\u9650 AliyunPrivateLinkFullAccess \u7ba1\u7406\u79c1\u7f51\u8fde\u63a5\uff08PrivateLink\uff09\u7684\u6743\u9650 \u670d\u52a1\u5b9e\u4f8b\u8ba1\u8d39\u8bf4\u660e \u6d4b\u8bd5\u672c\u670d\u52a1\u5728\u8ba1\u7b97\u5de2\u4e0a\u7684\u8d39\u7528\u4e3b\u8981\u6d89\u53ca\uff1a \u6240\u9009vCPU\u4e0e\u5185\u5b58\u89c4\u683c \u7cfb\u7edf\u76d8\u7c7b\u578b\u53ca\u5bb9\u91cf \u516c\u7f51\u5e26\u5bbd \u79c1\u7f51\u8fde\u63a5\u8d39\u7528 \u8ba1\u8d39\u65b9\u5f0f\u5305\u62ec\uff1a \u6309\u91cf\u4ed8\u8d39\uff08\u5c0f\u65f6\uff09 \u5305\u5e74\u5305\u6708 \u76ee\u524d\u63d0\u4f9b\u5982\u4e0b\u5957\u9910\uff1a \u5957\u9910\u540d SLB\u89c4\u683c ECS\u89c4\u683c\u65cf vCPU\u4e0e\u5185\u5b58 \u7cfb\u7edf\u76d8 \u516c\u7f51\u5e26\u5bbd \u4f4e\u914d\u7248 slb.s1.small ecs.c6.large \u5185\u5b58\u578bc6\uff0c2vCPU 4GiB ESSD\u4e91\u76d8 200GiB PL0 \u56fa\u5b9a\u5e26\u5bbd1Mbps \u57fa\u7840\u7248 slb.s1.small ecs.c6.xlarge \u5185\u5b58\u578bc6\uff0c4vCPU 8GiB ESSD\u4e91\u76d8 200GiB PL0 \u56fa\u5b9a\u5e26\u5bbd1Mbps \u9ad8\u914d\u7248 slb.s3.small ecs.c6.2xlarge \u5185\u5b58\u578bc6\uff0c4vCPU 8GiB ESSD\u4e91\u76d8 200GiB PL0 \u56fa\u5b9a\u5e26\u5bbd1Mbps \u9884\u4f30\u8d39\u7528\u5728\u521b\u5efa\u5b9e\u4f8b\u65f6\u53ef\u5b9e\u65f6\u770b\u5230\u3002\u79c1\u7f51\u8fde\u63a5\u53ea\u6709\u5728\u521b\u5efa\u670d\u52a1\u65f6\u5019\u5e76\u5efa\u7acb\u8fde\u63a5\u540e\u624d\u4f1a\u8ba1\u8d39\uff0c\u5177\u4f53\u7684\u8ba1\u8d39\u65b9\u5f0f\u53ef\u4ee5\u53c2\u8003\uff1ahttps://help.aliyun.com/document_detail/198081.html?spm=a2c4g.120462.0.0.5f104bffA7i9WJ \u90e8\u7f72\u6d41\u7a0b \u90e8\u7f72\u53c2\u6570\u8bf4\u660e \u53c2\u6570\u65cf \u53c2\u6570\u9879 \u8bf4\u660e \u57fa\u7840\u914d\u7f6e \u6570\u636e\u5e93root\u548cadmin\u8d26\u6237\u5bc6\u7801 \u6570\u636e\u5e93root\u548cadmin\u8d26\u6237\u5bc6\u7801\uff0c\u957f\u5ea68-32\u4e2a\u5b57\u7b26\uff0c\u53ef\u5305\u542b\u5927\u5c0f\u5b57\u6bcd\u3001\u6570\u5b57\u53ca\u7279\u6b8a\u7b26\u53f7\uff08\u5305\u542b\uff1a!@#$%^&*-+=_\uff09\u3002 \u7f51\u7edc\u914d\u7f6e \u53ef\u7528\u533a \u9009\u62e9\u53ef\u7528\u533a\uff0c\u8d44\u6e90\u5c06\u5728\u670d\u52a1\u5546\u7684\u8be5\u53ef\u7528\u533a\u521b\u5efa\u3002 \u7f51\u7edc\u8bbe\u7f6e \u4e13\u6709\u7f51\u7edc \u9009\u62e9\u5efa\u7acb\u79c1\u7f51\u8fde\u63a5\u7684VPC\u3002 \u7f51\u7edc\u8bbe\u7f6e \u5b89\u5168\u7ec4 \u9009\u62e9\u5efa\u7acb\u79c1\u7f51\u8fde\u63a5\u7684\u5b89\u5168\u7ec4\u3002 \u7f51\u7edc\u8bbe\u7f6e \u4ea4\u6362\u673a\u548c\u53ef\u7528\u533a \u9009\u62e9\u5efa\u7acb\u79c1\u7f51\u8fde\u63a5\u7684\u53ef\u7528\u533a\u4e0e\u4ea4\u6362\u673a\u3002 \u90e8\u7f72\u6b65\u9aa4 \u90e8\u7f72\u94fe\u63a5 \u5355\u51fb\u90e8\u7f72\u94fe\u63a5\uff0c\u8fdb\u5165\u670d\u52a1\u5b9e\u4f8b\u90e8\u7f72\u754c\u9762\uff0c\u6839\u636e\u754c\u9762\u63d0\u793a\uff0c\u586b\u5199\u53c2\u6570\u5b8c\u6210\u90e8\u7f72\u3002 \u7f51\u7edc\u8bbe\u7f6e\u90e8\u5206\u5982\u679c\u586b\u5199\u7f51\u7edc\u4fe1\u606f\uff0c\u79c1\u7f51\u8fde\u63a5\u7684\u7ec8\u7aef\u8282\u70b9\u5c06\u5728\u8be5\u53ef\u7528\u533a\u521b\u5efa\u3002 \u6ce8\uff1a\u7531\u4e8e\u672c\u670d\u52a1\u5f00\u542f\u4e86\u7f51\u7edc\u53d8\u914d\u529f\u80fd\uff0c\u82e5\u6b64\u5904\u4e0d\u5f00\u542f\u79c1\u7f51\u8fde\u63a5\uff0c\u4e5f\u53ef\u901a\u8fc7\u53d8\u914d\u529f\u80fd\u5f00\u542f\u3002\u8be6\u60c5\u89c1\u53d8\u914d\u6d41\u7a0b-\u53d8\u914d\u79c1\u7f51\u8fde\u63a5\u3002 2. \u53c2\u6570\u586b\u5199\u5b8c\u6210\u540e\u70b9\u51fb \u4e0b\u4e00\u6b65\uff1a\u786e\u8ba4\u8ba2\u5355 \u786e\u8ba4\u53c2\u6570\u3002 3. \u786e\u8ba4\u8ba2\u5355\u5b8c\u6210\u540e\u540c\u610f\u670d\u52a1\u534f\u8bae\u5e76\u70b9\u51fb \u7acb\u5373\u521b\u5efa \uff0c\u968f\u540e\u8fdb\u5165\u90e8\u7f72\u9636\u6bb5\u3002 4. \u7b49\u5f85\u90e8\u7f72\u5b8c\u6210\u540e\u5c31\u53ef\u4ee5\u5f00\u59cb\u4f7f\u7528\u670d\u52a1\u3002 5. \u4f7f\u7528\u670d\u52a1 1. \u672c\u670d\u52a1\u652f\u6301\u79c1\u7f51\u8bbf\u95ee\uff0c\u79df\u6237\u53ef\u4ee5\u901a\u8fc7PrivateLink\u5b9e\u73b0\u79c1\u7f51\u8bbf\u95ee\uff08 \u79c1\u7f51\u8bbf\u95ee\u5e2e\u52a9\u6587\u6863 \uff09\uff0c \u79df\u6237\u79c1\u7f51\u8bbf\u95ee\u6d41\u7a0b\uff1a 1. \u5728\u670d\u52a1\u5b9e\u4f8b\u7684\u865a\u62df\u4e92\u8054\u7f51\u9875\u7b7e\u4e2d\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\uff0c\u8fde\u63a5\u65f6\u53ef\u4ee5\u901a\u8fc7\u81ea\u5b9a\u4e49\u57df\u540d\uff08\u5982\u679c\u5728\u521b\u5efa\u670d\u52a1\u5b9e\u4f8b\u65f6\u52fe\u9009\u4e86\u7684\u8bdd\uff09\u3001IP\u5730\u5740\u6216\u8005\u53ef\u7528\u533a\u57df\u540d\u8fdb\u884c\u8bbf\u95ee\u3002 2. \u5728\u5bf9\u5e94\u7684vsw\u4e2d\u521b\u5efaECS\uff0c\u521b\u5efa\u597d\u540e\u5b89\u88c5mysql\u5ba2\u6237\u7aef\u3002 yum install mysql or apt install mysql-client 3. \u5728\u8be5ECS\u4e2d\u8fde\u63a5MySQL\uff0c\u4e0b\u9762\u5c55\u793a\u5206\u522b\u7528\u81ea\u5b9a\u4e49\u57df\u540d\u3001IP\u4e0e\u53ef\u7528\u533a\u57df\u540d\u8fdb\u884c\u8fde\u63a5\uff1a 1. \u81ea\u5b9a\u4e49\u57df\u540d\u65b9\u5f0f\u8bbf\u95ee\uff1a ![\u81ea\u5b9a\u4e49\u57df\u540d\u8bbf\u95ee.png](\u81ea\u5b9a\u4e49\u57df\u540d\u8bbf\u95ee.png) 2. \u901a\u8fc7IP\u8bbf\u95ee\uff1a ![\u901a\u8fc7ip\u8bbf\u95ee.png](\u901a\u8fc7ip\u8bbf\u95ee.png) 3. \u901a\u8fc7\u53ef\u7528\u533a\u57df\u540d\u8bbf\u95ee\uff1a ![\u901a\u8fc7\u53ef\u7528\u533a\u57df\u540d\u8bbf\u95ee.png](\u901a\u8fc7\u53ef\u7528\u533a\u57df\u540d\u8bbf\u95ee.png) \u672c\u670d\u52a1\u652f\u6301\u4fee\u6539\u670d\u52a1\u914d\u7f6e\u53c2\u6570\u3002 \u8bf7\u6ce8\u610f\uff0c\u4fee\u6539\u53c2\u6570\u4f1a\u5f15\u8d77\u670d\u52a1\u91cd\u542f \u3002\u4fee\u6539\u670d\u52a1\u53c2\u6570\u7684\u6d41\u7a0b\uff1a \u8fdb\u5165\u670d\u52a1\u5b9e\u4f8b\u8be6\u60c5\uff1a \u70b9\u51fb \u4fee\u6539\u53c2\u6570 \uff0c\u7f16\u8f91\u4fee\u6539\u503c\uff0c\u5b8c\u6210\u540e\u70b9\u51fb \u4fdd\u5b58 \u3002 \u70b9\u51fb\u4fdd\u5b58\u540e\uff0c\u670d\u52a1\u5b9e\u4f8b\u4f1a\u8fdb\u5165\u53c2\u6570\u66f4\u65b0\u6d41\u7a0b\uff0c\u5927\u81f4\u9700\u89811~2\u5206\u949f\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u3002 \u53c2\u6570\u66f4\u65b0\u6d41\u7a0b\u5b8c\u6210\u540e\uff0c\u53c2\u6570\u751f\u6548\u3002 \u53d8\u914d\u6d41\u7a0b \u8bf4\u660e \u672c\u670d\u52a1\u9ed8\u8ba4\u5f00\u542f\u652f\u6301\u53d8\u914d\u79c1\u7f51\u8fde\u63a5\u3001\u652f\u6301\u6570\u636e\u76d8\u6269\u5bb9\u3002 \u79c1\u7f51\u8fde\u63a5\u53d8\u914d\uff1a\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u53d8\u914d\u5f00\u542f/\u5173\u95ed/\u65b0\u589e/\u5220\u9664\u79c1\u7f51\u8fde\u63a5\uff1b \u6570\u636e\u76d8\u6269\u5bb9\uff1a\u7528\u6237\u53ef\u901a\u8fc7\u53d8\u914d\u6269\u5bb9\u6570\u636e\u76d8\u5bb9\u91cf\u3002 \u53d8\u914d\u79c1\u7f51\u8fde\u63a5\u6b65\u9aa4 \u524d\u63d0\u8bf4\u660e\uff1a\u672c\u53d8\u914d\u793a\u4f8b\u4e3a\u7528\u6237\u5728\u521b\u5efa\u670d\u52a1\u5b9e\u4f8b\u65f6\u672a\u5f00\u542f\u79c1\u7f51\u8fde\u63a5\uff0c\u5728\u670d\u52a1\u5b9e\u4f8b\u521b\u5efa\u5b8c\u6210\u540e\u9700\u8981\u5f00\u542f\u3002 \u7528\u6237\u5df2\u6709\u670d\u52a1\u5b9e\u4f8b\u672a\u5f00\u542f\u79c1\u7f51\u8fde\u63a5\u3002 \u70b9\u51fb\u53f3\u4e0a\u89d2 \u4fee\u6539\u914d\u7f6e \u8fdb\u5165\u53d8\u914d\u670d\u52a1\u5b9e\u4f8b\u9875\u9762\uff0c\u9009\u62e9 \u7f51\u7edc\u53d8\u914d \u3002 \u70b9\u51fb \u4e0b\u4e00\u6b65 \u8fdb\u5165 \u8bbe\u7f6e\u4fee\u6539\u53c2\u6570 \uff0c\u6dfb\u52a0\u79c1\u7f51\u8fde\u63a5\u53c2\u6570\u3002 \u6ce8\u610f\uff1a\u8bf7\u786e\u4fdd\u586b\u5165\u7684\u5b89\u5168\u7ec4\u5165\u65b9\u5411\u5f00\u542f3306\u7aef\u53e3\uff0c\u5426\u5219\u79c1\u7f51\u8bbf\u95ee\u5c06\u65e0\u6cd5\u8fde\u63a5\u3002 \u70b9\u51fb \u4e0b\u4e00\u6b65 \u9884\u89c8\u53d8\u914d\u5185\u5bb9\u3002 \u70b9\u51fb \u786e\u5b9a \u5f00\u59cb\u6267\u884c\u53d8\u914d\uff0c\u7b49\u5f85\u53d8\u914d\u5b8c\u6210\u3002 \u53d8\u914d\u5b8c\u6210\uff0c\u670d\u52a1\u5b9e\u4f8b\u72b6\u6001\u53d8\u4e3a\u5df2\u90e8\u7f72\uff0c\u8fdb\u5165\u7f51\u7edc\u914d\u7f6e\u53ef\u89c1\u65b0\u589e\u7684\u79c1\u7f51\u8fde\u63a5\u4fe1\u606f\u3002\u4e4b\u540e\u4fbf\u53ef\u901a\u8fc7 \u90e8\u7f72\u6d41\u7a0b \u6b65\u9aa45\u6240\u8ff0\u5b8c\u6210\u8fde\u63a5\u3002 \u540e\u7eed\u82e5\u9700\u8981\u5173\u95ed/\u65b0\u589e/\u5220\u9664\u79c1\u7f51\u8bbf\u95ee\u7b49\u5176\u4ed6\u64cd\u4f5c\uff0c\u540c\u6837\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u914d\u7f6e-\u7f51\u7edc\u53d8\u914d\u5b8c\u6210\u3002 \u78c1\u76d8\u5bb9\u91cf\u6269\u5bb9\u6b65\u9aa4 \u524d\u63d0\u8bf4\u660e \u672c\u53d8\u914d\u793a\u4f8b\u4e3a\u7528\u6237\u6269\u5bb9\u78c1\u76d8\u5bb9\u91cf\uff0c\u670d\u52a1\u6a21\u677f\u4e2d\u5c06\"\u6269\u5bb9\u78c1\u76d8\u5bb9\u91cf\"\u53d8\u914d\u7c7b\u578b\u8bbe\u7f6e\u4e3a\u5347\u914d\uff0c\u5373\u4ec5\u80fd\u6269\u5bb9\uff1b \u4e3a\u4f7f\u78c1\u76d8\u53ef\u53d8\u914d\u4e0e\u811a\u672c\u53ef\u6267\u884c\uff0c\u670d\u52a1\u6a21\u677f\u4e2d\u8d44\u6e90EcsInstanceGroup\u53c2\u6570UpdatePolicy\u9700\u8bbe\u7f6e\u4e3aForAllInstances\uff0c\u8d44\u6e90RunCommand\u53c2\u6570Sync\u9700\u8bbe\u7f6e\u4e3atrue\u3002 \u4ee5\u4e0a\u53c2\u6570\u6a21\u677f\u4e2d\u5747\u5df2\u914d\u7f6e\u597d\uff0c\u6b64\u5904\u4ec5\u544a\u77e5\u3002 \u70b9\u51fb\u53f3\u4e0a\u89d2 \u4fee\u6539\u914d\u7f6e \u8fdb\u5165\u53d8\u914d\u670d\u52a1\u5b9e\u4f8b\u9875\u9762\uff0c\u9009\u62e9 \u78c1\u76d8\u5bb9\u91cf\u6269\u5bb9 \u3002 \u70b9\u51fb \u4e0b\u4e00\u6b65 \u8fdb\u5165 \u8bbe\u7f6e\u4fee\u6539\u53c2\u6570 \uff0c\u5c06\u539f\u6709\u78c1\u76d8\u5bb9\u91cf\u4ece200GB\u4fee\u6539\u4e3a400GB\u3002 \u70b9\u51fb \u4e0b\u4e00\u6b65 \u9884\u89c8\u53d8\u914d\u53c2\u6570\u3002 \u70b9\u51fb\u786e\u5b9a\u5f00\u59cb\u6267\u884c\u53d8\u914d\uff0c\u7b49\u5f85\u53d8\u914d\u5b8c\u6210\u3002 \u53d8\u914d\u5b8c\u6210\uff0c\u670d\u52a1\u5b9e\u4f8b\u72b6\u6001\u53d8\u4e3a\u5df2\u90e8\u7f72\u3002 \u67e5\u770b\u7ed3\u679c\uff1a\u8fdb\u5165\u670d\u52a1\u7aefECS \u901a\u8fc7\u547d\u4ee4 df -h \u67e5\u770b\uff0c\u78c1\u76d8\u5bb9\u91cf\u5df2\u4fee\u6539: \u53d8\u914d\u524d\uff1a \u53d8\u914d\u540e\uff1a \u670d\u52a1\u8be6\u7ec6\u8bf4\u660e \u672c\u6587\u63d0\u524d\u5c06MySQL\u793e\u533a\u7248\u5b89\u88c5\u5305\u5b58\u653e\u5230\u8be5Github Repo\u4e2d\uff0c\u6784\u5efa\u670d\u52a1\u8fc7\u7a0b\u4e2d\u4f1a\u5c06\u8be5\u5b89\u88c5\u5305\u53d1\u5e03\u4e3a\u8ba1\u7b97\u5de2\u90e8\u7f72\u7269\uff0c\u5e76\u5728ROS\u6a21\u677f\u5199\u5165\u5b89\u88c5\u6307\u4ee4\uff0cROS\u6a21\u677f\u5f15\u64ce\u5728\u6267\u884c\u65f6\u4fbf\u4f1a\u81ea\u52a8\u6267\u884c\u5b89\u88c5\u4e86\u3002 wget '{{ computenest::file::MySQL }}' -O mysql-community-release-el6-5.noarch.rpm rpm -ivh mysql-community-release-el6-5.noarch.rpm yum repolist all | grep mysql yum install mysql-community-server -y {{ computenest::file::MySQL }} \u4e3a\u5360\u4f4d\u7b26\uff0c\u4f1a\u7531\u8ba1\u7b97\u5de2\u670d\u52a1\u66ff\u6362\u6210\u6587\u4ef6\u90e8\u7f72\u7269MySQL\u7684http\u4e0b\u8f7d\u5730\u5740\u3002 \u6587\u4ef6\u8bf4\u660e \u6587\u4ef6\u8def\u5f84 \u8bf4\u660e config.yaml \u6784\u5efa\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u670d\u52a1\u6784\u5efa\u8fc7\u7a0b\u4e2d\u4f1a\u4f7f\u7528\u8ba1\u7b97\u5de2\u547d\u4ee4\u884c\u5de5\u5177 computenest-cli \uff0ccomputenest-cli\u4f1a\u57fa\u4e8e\u8be5\u914d\u7f6e\u6587\u4ef6\u6784\u5efa\u670d\u52a1\u3002 parameters.yaml \u672c\u670d\u52a1\u4e3a\u6258\u7ba1\u7248\u5355\u79df\uff0c\u4f7f\u7528\u8be5\u6587\u4ef6\u6e32\u67d3\u670d\u52a1\u5546\u9700\u8981\u914d\u7f6e\u7684\u7f51\u7edc\u53c2\u6570\uff0c\u5305\u62ecVpcId\uff0cVSwitch\u7b49\u3002 artifact/mysql-community-release-el6-5.noarch.rpm MySQL\u793e\u533a\u7248\u5b89\u88c5\u5305\uff0c\u6784\u5efa\u8fc7\u7a0b\u4f1a\u5c06\u8be5\u5305\u53d1\u5e03\u4e3a\u8ba1\u7b97\u5de2\u90e8\u7f72\u7269\u3002 icons/service_logo.jpg \u6784\u5efa\u670d\u52a1\u9ed8\u8ba4\u7684\u56fe\u6807\u3002 templates/parameters.yaml \u672c\u670d\u52a1\u4e3a\u6258\u7ba1\u7248\u5355\u79df\u670d\u52a1\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u7528\u6237\u586b\u5199\u4e00\u90e8\u5206\u53c2\u6570\uff0c\u901a\u8fc7\u8be5\u6587\u4ef6\u6307\u5b9a\u7528\u6237\u6240\u586b\u53c2\u6570\u3002 templates/template.yaml ROS\u6a21\u677f\u6587\u4ef6\uff0cROS\u6a21\u677f\u5f15\u64ce\u6839\u636e\u8be5\u6a21\u677f\u80fd\u591f\u81ea\u52a8\u521b\u5efa\u51fa\u6240\u6709\u7684\u8d44\u6e90\u3002 templates/template.yaml\u4e3b\u8981\u7531\u4e09\u90e8\u5206\u7ec4\u6210 Parameters\u5b9a\u4e49\u9700\u8981\u7528\u6237\u586b\u5199\u7684\u53c2\u6570\uff0c\u5305\u62ec\u4ed8\u8d39\u7c7b\u578b\uff0c\u5b9e\u4f8b\u89c4\u683c\u548c\u5b9e\u4f8b\u5bc6\u7801\u53ef\u7528\u533a\u53c2\u6570\u3002 ZoneId: Type: String AssociationProperty: ALIYUN::ECS::Instance:ZoneId Label: en: VSwitch Available Zone zh-cn: \u53ef\u7528\u533a # \u6570\u636e\u5e93root\u8d26\u6237\u5bc6\u7801 Password: # \u67e5\u8be2\u8be5\u53c2\u6570\u65f6\u53ea\u8f93\u51fa\u661f\u53f7\uff08*\uff09 NoEcho: true Type: String Description: en: 'Database root account passwor, 8-32 characters, including uppercase and lowercase letters, numbers and special symbols (including: !@#$%^&*-+=_).' zh-cn: \u6570\u636e\u5e93root\u8d26\u6237\u5bc6\u7801\uff0c\u957f\u5ea68-32\u4e2a\u5b57\u7b26\uff0c\u53ef\u5305\u542b\u5927\u5c0f\u5b57\u6bcd\u3001\u6570\u5b57\u53ca\u7279\u6b8a\u7b26\u53f7\uff08\u5305\u542b\uff1a!@#$%^&*-+=_\uff09\u3002 Label: en: Root Account Password zh-cn: \u6570\u636e\u5e93root\u8d26\u6237\u5bc6\u7801 ConstraintDescription: en: '8-32 characters, including uppercase and lowercase letters, numbers and special symbols (including: !@#$%^&*-+=_).' zh-cn: 8-32\u4e2a\u5b57\u7b26\uff0c\u53ef\u5305\u542b\u5927\u5c0f\u5b57\u6bcd\u3001\u6570\u5b57\u53ca\u7279\u6b8a\u7b26\u53f7\uff08\u5305\u542b\uff1a!@#$%^&*-+=_\uff09\u3002 MinLength: '8' MaxLength: '32' AssociationProperty: ALIYUN::ECS::Instance::Password # \u4e13\u6709\u7f51\u7edcVPC\u5b9e\u4f8bID VpcId: AssociationProperty: ALIYUN::ECS::VPC::VPCId Type: String Label: en: VPC ID zh-cn: \u4e13\u6709\u7f51\u7edcVPC\u5b9e\u4f8bID # \u4ea4\u6362\u673a\u5b9e\u4f8bID VSwitchId: AssociationProperty: ALIYUN::ECS::VSwitch::VSwitchId AssociationPropertyMetadata: VpcId: ${VpcId} ZoneId: ${ZoneId} Type: String Label: en: VSwitch ID zh-cn: \u4ea4\u6362\u673a\u5b9e\u4f8bID # \u6570\u636e\u76d8\u5927\u5c0f DataDiskSize: Description: zh-cn: ECS\u5b9e\u4f8b\u6570\u636e\u76d8\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aGiB\u3002\u53d6\u503c\u8303\u56f4\uff1a100~32768 en: 'ECS Instance disk size, range of values: 100-32768, units: GB' Default: 200 MaxValue: 32768 MinValue: 100 Label: zh-cn: \u6570\u636e\u76d8\u7a7a\u95f4 en: Data Disk Space Type: Number # Ecs\u5b9e\u4f8b\u7c7b\u578b EcsInstanceType: Type: String Label: en: Instance Type zh-cn: Ecs\u5b9e\u4f8b\u7c7b\u578b AssociationProperty: ALIYUN::ECS::Instance::InstanceType AllowedValues: - ecs.c6.large - ecs.c6.xlarge - ecs.c6.2xlarge - ecs.c6.4xlarge SlbInstanceType: Type: String Label: en: Instance Type zh-cn: Slb\u5b9e\u4f8b\u7c7b\u578b AssociationProperty: ALIYUN::Slb::LoadBalance::LoadBalancerSpec AllowedValues: - slb.s1.small - slb.s3.small Resources\u5b9a\u4e49\u9700\u8981\u5f00\u7684\u8d44\u6e90\uff0c\u5305\u62ec\u65b0\u5f00\u7684Vpc,\u3001VSwitch\u3001ECS\u3001Slb\u5b9e\u4f8b\u3001\u79c1\u7f51\u8fde\u63a5\u3002 EcsSecurityGroup: Type: 'ALIYUN::ECS::SecurityGroup' Properties: VpcId: Ref: VpcId SecurityGroupIngress: - Priority: 1 PortRange: 3306/3306 NicType: internet SourceCidrIp: 0.0.0.0/0 IpProtocol: tcp # Ecs\u5b9e\u4f8b EcsInstanceGroup: Type: ALIYUN::ECS::InstanceGroup Properties: # I/O\u4f18\u5316\u5b9e\u4f8b IoOptimized: optimized ZoneId: Ref: ZoneId DiskMappings: - Category: cloud_essd Device: /dev/xvdb Size: Ref: DataDiskSize SystemDiskSize: 40 # \u4ed8\u8d39\u65b9\u5f0f\uff1a\u6309\u91cf\u4ed8\u8d39 InstanceChargeType: PostPaid MaxAmount: 1 # \u7cfb\u7edf\u76d8\u7c7b\u578b\uff1acloud_essd SystemDiskCategory: cloud_essd # \u5b9e\u4f8b\u540d\u79f0 InstanceName: Ref: ALIYUN::StackName VpcId: Ref: VpcId SecurityGroupId: Ref: EcsSecurityGroup VSwitchId: Ref: VSwitchId # \u6307\u5b9aCentOS 7.9\u955c\u50cf\uff0c\u5982\u679c\u4fee\u6539\u955c\u50cf\uff0cUserData\u811a\u672c\u9700\u8981\u8fdb\u884c\u9002\u914d ImageId: \"centos_7_9_x64_20G_alibase_20220727.vhd\" InstanceType: Ref: EcsInstanceType # \u4e3b\u673a\u540d HostName: Ref: ALIYUN::StackName # Ecs\u767b\u5f55\u5bc6\u7801 Password: Ref: Password # \u662f\u5426\u4e3a\u5b9e\u4f8b\u5206\u914d\u516c\u7f51IP AllocatePublicIP: true InternetMaxBandwidthOut: 1 # ECS\u6267\u884c\u811a\u672c RunCommand: Type: ALIYUN::ECS::RunCommand Properties: CommandContent: Fn::Sub: - | #!/bin/sh FLAG_FILE=\"/root/.disk_initialized\" PARTITION=/dev/vdb1 MOUNT_POINT=/data1 initialize_disk() { # \u521d\u59cb\u5316\u6570\u636e\u76d8\uff0c\u5bf9\u6570\u636e\u76d8\u5206\u533a cat >> /root/InitDataDisk.sh << EOF #!/bin/bash echo \"p n p w \" | fdisk -u /dev/vdb EOF /bin/bash /root/InitDataDisk.sh rm -f /root/InitDataDisk.sh rm -f InitDataDisk.sh # \u5728\u65b0\u5206\u533a\u4e0a\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf mkfs.ext4 /dev/vdb1 # \u521b\u5efa\u76ee\u5f55\uff0cMySQL\u5c06\u5b89\u88c5\u5728\u8be5\u76ee\u5f55\u4e0b mkdir /data1 # \u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf mount /dev/vdb1 /data1 # \u5411 /etc/fstab \u5199\u5165\u65b0\u5206\u533a\u4fe1\u606f echo /dev/vdb1 /data1 ext4 defaults,nodelalloc,noatime 0 2 >> /etc/fstab } install_mysql() { # \u5b89\u88c5\u793e\u533a\u7248MySQL cd /data1/ wget '{{ computenest::file::MySQL }}' -O mysql-community-release-el6-5.noarch.rpm rpm -ivh mysql-community-release-el6-5.noarch.rpm yum repolist all | grep mysql yum install mysql-community-server -y # \u542f\u52a8MySQL\u670d\u52a1 service mysqld start } configure_mysql() { # \u4ee5\u8d85\u7ea7\u7528\u6237\u8eab\u4efd\u767b\u5165\uff0c\u521b\u5efaadmin\u7528\u6237\uff0c\u5e76\u5141\u8bb8admin\u7528\u6237\u4ee5Password\u4e3a\u5bc6\u7801\u8fdc\u7a0b\u767b\u5f55 mysqladmin -u root password '${Password}' echo \"create database test character set utf8 collate utf8_bin;\" > ./test.sql echo \"CREATE USER 'admin'@'%' IDENTIFIED BY '${Password}';\" >> ./test.sql echo \"GRANT ALL PRIVILEGES ON *.* TO 'admin'@'%' WITH GRANT OPTION;\" >> ./test.sql mysql -u root -p'${Password}' < ./test.sql } move_mysql_data() { # \u5c06MySQL\u7684\u914d\u7f6e\u548c\u6570\u636e\u8def\u5f84\u79fb\u52a8\u5230\u6570\u636e\u76d8\u4e0a systemctl stop mysqld rsync -av /var/lib/mysql /data1 # \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 sed -i 's/\\/var\\/lib/\\/data1/g' /etc/my.cnf echo -e '\\n' >> /etc/my.cnf echo '[client]' >> /etc/my.cnf echo 'port=3306' >> /etc/my.cnf echo 'socket=/data1/mysql/mysql.sock' >> /etc/my.cnf # \u91cd\u542fMySQL systemctl start mysqld } expand_partition() { # \u4f7f\u7528 growpart \u6269\u5c55\u5206\u533a echo \"Expanding partition...\" if ! growpart /dev/vdb 1; then echo \"Failed to expand partition\" exit 1 fi # \u901a\u77e5\u7cfb\u7edf\u5206\u533a\u7684\u66f4\u6539 partprobe $PARTITION # \u4f7f\u7528 e2fsck \u68c0\u67e5\u6587\u4ef6\u7cfb\u7edf echo \"Checking filesystem...\" e2fsck -f -y $PARTITION # \u6269\u5c55\u6587\u4ef6\u7cfb\u7edf echo \"Resizing filesystem...\" resize2fs $PARTITION } if [ ! -f \"$FLAG_FILE\" ]; then # \u9996\u6b21\u521b\u5efaECS\u65f6\u6267\u884c # \u786e\u4fdd\u7f51\u7edc\u5c31\u7eea sleep 15 initialize_disk install_mysql configure_mysql move_mysql_data # \u5f53\u521d\u59cb\u5316\u5b8c\u6210\u540e\uff0c\u521b\u5efa\u4e00\u4e2a\u6807\u5fd7\u6587\u4ef6 touch \"$FLAG_FILE\" echo \"Initialization complete. Flag file created.\" # \u6267\u884c\u6210\u529f\u56de\u8c03WaitCondition\u7ed3\u675fWaitCondition\u7684\u7b49\u5f85 ${CurlCli} -d \"{\\\"Data\\\" : \\\"SUCCESS\\\", \\\"Status\\\" : \\\"SUCCESS\\\"}\" else # \u6269\u5bb9\u6570\u636e\u76d8\u65f6\u6267\u884c # \u505c\u6b62MySQL\u670d\u52a1 systemctl stop mysqld # \u68c0\u67e5\u5e76\u786e\u4fdd\u5206\u533a\u672a\u88ab\u6302\u8f7d if mountpoint -q $MOUNT_POINT; then umount $MOUNT_POINT fi expand_partition # \u91cd\u65b0\u6302\u8f7d\u5206\u533a echo \"Remounting partition...\" mount $PARTITION $MOUNT_POINT # \u542f\u52a8MySQL\u670d\u52a1 systemctl start mysqld fi # \u83b7\u53d6\u5230WaitConditionHandle\u7684\u5730\u5740\u653e\u5230 ${CurlCli}\u53d8\u91cf\u91cc - CurlCli: Fn::GetAtt: - WaitConditionHandle - CurlCli # \u6570\u636e\u5e93root\u8d26\u6237\u5bc6\u7801 Password: Ref: Password Type: RunShellScript Timeout: 900 Sync: true InstanceIds: - Ref: EcsInstanceGroup Slb: Type: ALIYUN::SLB::LoadBalancer Properties: LoadBalancerName: Fn::Join: - '-' - - mysql - Ref: ALIYUN::StackName VpcId: Ref: VpcId VSwitchId: Ref: VSwitchId PayType: PayOnDemand AddressType: intranet LoadBalancerSpec: Ref: SlbInstanceType SupportPrivateLink: true SlbBackendServerAttachment: DependsOn: - EcsInstanceGroup Type: ALIYUN::SLB::BackendServerAttachment Properties: BackendServerList: Fn::GetAtt: - EcsInstanceGroup - InstanceIds LoadBalancerId: Ref: Slb BackendServerWeightList: - 100 - 0 SlbListener: DependsOn: Slb Type: ALIYUN::SLB::Listener Properties: Persistence: CookieTimeout: 60 StickySession: 'on' PersistenceTimeout: 180 XForwardedFor: 'off' StickySessionType: insert ListenerPort: 3306 Bandwidth: -1 HealthCheck: HttpCode: http_2xx,http_3xx,http_4xx,http_5xx HealthCheckType: tcp UnhealthyThreshold: 3 Timeout: 5 HealthyThreshold: 3 Port: 3306 URI: / Interval: 2 LoadBalancerId: Ref: Slb BackendServerPort: 3306 Protocol: tcp VpcEndpointService: DependsOn: Slb Type: ALIYUN::PrivateLink::VpcEndpointService Properties: ServiceDescription: isv service Resource: - ZoneId: Ref: ZoneId ResourceId: Ref: Slb ResourceType: slb AutoAcceptEnabled: true Outputs\u5b9a\u4e49\u9700\u8981\u6700\u7ec8\u5728\u8ba1\u7b97\u5de2\u6982\u89c8\u9875\u4e2d\u5bf9\u7528\u6237\u5c55\u793a\u7684\u8f93\u51fa Outputs: EndpointServiceId: Description: en: EndpointService Id zh-cn: \u7ec8\u7aef\u8282\u70b9\u670d\u52a1Id Value: Fn::GetAtt: - VpcEndpointService - ServiceId Endpoint: Value: Fn::Join: - '' - - Ref: ALIYUN::StackName - .mysql.com MysqlUserName: Description: en: MySQL User Name zh-cn: MySQL\u767b\u5f55\u7528\u6237\u540d Value: admin \u670d\u52a1\u914d\u7f6e \u521b\u5efa\u4ee3\u8fd0\u7ef4\u670d\u52a1\u5b8c\u6210\u5b9e\u4f8b\u8fd0\u7ef4 \u521b\u5efa\u5305\u542b\u53d8\u914d\u529f\u80fd\u7684\u670d\u52a1 \u521b\u5efa\u5305\u542b\u670d\u52a1\u5347\u7ea7\u529f\u80fd\u7684\u670d\u52a1 \u670d\u52a1\u4ea4\u4ed8 \u81ea\u5b9a\u4e49\u670d\u52a1\u67b6\u6784\u56fe \u670d\u52a1\u6587\u6863\u4e0a\u7ebf\u6d41\u7a0b \u5c06\u670d\u52a1\u4e0a\u67b6\u4e91\u5e02\u573a\u5e76\u4e0a\u5230\u4e91\u5e02\u573a\u552e\u5356","title":"\u670d\u52a1\u6a21\u677f\u8bf4\u660e\u6587\u6863"},{"location":"#_1","text":"","title":"\u670d\u52a1\u6a21\u677f\u8bf4\u660e\u6587\u6863"},{"location":"#_2","text":"\u672c\u6587\u4ecb\u7ecd\u57fa\u4e8eMySQL\u8f6f\u4ef6\u5305\u5feb\u901f\u6784\u5efa\u6258\u7ba1\u7248\u5355\u79df\u6237\u8ba1\u7b97\u5de2\u670d\u52a1\uff0c\u5173\u4e8e\u8ba1\u7b97\u5de2\u6258\u7ba1\u7248\u53ef\u4ee5\u53c2\u8003 \u5e2e\u52a9\u6587\u6863 \uff0c \u672c\u793a\u4f8b\u91c7\u7528ECS+SLB\u7684\u67b6\u6784\uff0c\u9ed8\u8ba4\u652f\u6301\u79c1\u7f51\u6253\u901a\u3001\u7f51\u7edc\u53d8\u914d\u4e0e\u78c1\u76d8\u6269\u5bb9\u529f\u80fd\u3002\u7528\u6237\u90e8\u7f72\u670d\u52a1\u5b9e\u4f8b\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u5185\u7f51\u8bbf\u95ee\u90e8\u7f72\u5728\u670d\u52a1\u5546\u7684MySQL\uff0c\u9664\u6b64\u4e4b\u5916\u8fd8\u914d\u7f6e\u4e86\u4e09\u79cd\u5957\u9910\uff0c\u5206\u522b\u4e3a\uff1a \u5957\u9910\u540d SLB\u89c4\u683c ECS\u89c4\u683c\u65cf vCPU\u4e0e\u5185\u5b58 \u7cfb\u7edf\u76d8 \u516c\u7f51\u5e26\u5bbd \u4f4e\u914d\u7248 slb.s1.small ecs.c6.large \u5185\u5b58\u578bc6\uff0c2vCPU 4GiB ESSD\u4e91\u76d8 200GiB PL0 \u56fa\u5b9a\u5e26\u5bbd1Mbps \u57fa\u7840\u7248 slb.s1.small ecs.c6.xlarge \u5185\u5b58\u578bc6\uff0c4vCPU 8GiB ESSD\u4e91\u76d8 200GiB PL0 \u56fa\u5b9a\u5e26\u5bbd1Mbps \u9ad8\u914d\u7248 slb.s3.small ecs.c6.2xlarge \u5185\u5b58\u578bc6\uff0c4vCPU 8GiB ESSD\u4e91\u76d8 200GiB PL0 \u56fa\u5b9a\u5e26\u5bbd1Mbps \u672c\u793a\u4f8b\u5bf9\u5e94\u7684Git\u4ed3\u5e93\u5730\u5740\uff1a mysql-managed-demo \u672c\u793a\u4f8b\u4f1a\u81ea\u52a8\u7684\u6784\u5efa\u8ba1\u7b97\u5de2\u670d\u52a1\uff0c\u5177\u4f53\u7684\u670d\u52a1\u6784\u5efa\u6d41\u7a0b\u4e3a: \u5c06MySQL\u5b89\u88c5\u5305\uff08\u63d0\u524d\u5b58\u653e\u5230\u8be5github repo\u4e2d\uff09\u6784\u5efa\u4e3a\u8ba1\u7b97\u5de2\u6587\u4ef6\u90e8\u7f72\u7269 \u521b\u5efa\u8ba1\u7b97\u5de2\u670d\u52a1\u5e76\u5173\u8054\u6587\u4ef6\u90e8\u7f72\u7269 \u521b\u5efa\u8fc7\u7a0b\u5927\u7ea6\u6301\u7eed3\u5206\u949f\uff0c\u5f53\u670d\u52a1\u53d8\u6210\u5f85\u63d0\u4ea4\u540e\u6784\u5efa\u6210\u529f\u3002","title":"\u670d\u52a1\u8bf4\u660e"},{"location":"#_3","text":"\u672c\u90e8\u7f72\u67b6\u6784\u4e3aSLB+ECS\uff0c\u5b89\u5168\u7ec4\u5f00\u653e3306\u7aef\u53e3\uff0c\u5e76\u914d\u7f6e\u4e86\u7ec8\u7aef\u8282\u70b9\u3002","title":"\u90e8\u7f72\u67b6\u6784"},{"location":"#_4","text":"\u6d4b\u8bd5\u672c\u670d\u52a1\u6784\u5efa\u65e0\u9700\u4efb\u4f55\u8d39\u7528\uff0c\u521b\u5efa\u670d\u52a1\u5b9e\u4f8b\u6d89\u53ca\u7684\u8d39\u7528\u53c2\u8003\u670d\u52a1\u5b9e\u4f8b\u8ba1\u8d39\u8bf4\u660e\u3002","title":"\u670d\u52a1\u6784\u5efa\u8ba1\u8d39\u8bf4\u660e"},{"location":"#ram","text":"\u672c\u670d\u52a1\u9700\u8981\u5bf9ECS\u3001VPC\u7b49\u8d44\u6e90\u8fdb\u884c\u8bbf\u95ee\u548c\u521b\u5efa\u64cd\u4f5c\uff0c\u82e5\u60a8\u4f7f\u7528RAM\u7528\u6237\u521b\u5efa\u670d\u52a1\u5b9e\u4f8b\uff0c\u9700\u8981\u5728\u521b\u5efa\u670d\u52a1\u5b9e\u4f8b\u524d\uff0c\u5bf9\u4f7f\u7528\u7684RAM\u7528\u6237\u7684\u8d26\u53f7\u6dfb\u52a0\u76f8\u5e94\u8d44\u6e90\u7684\u6743\u9650\u3002\u6dfb\u52a0RAM\u6743\u9650\u7684\u8be6\u7ec6\u64cd\u4f5c\uff0c\u8bf7\u53c2\u89c1 \u4e3aRAM\u7528\u6237\u6388\u6743 \u3002\u6240\u9700\u6743\u9650\u5982\u4e0b\u8868\u6240\u793a\u3002 \u6743\u9650\u7b56\u7565\u540d\u79f0 \u5907\u6ce8 AliyunECSFullAccess \u7ba1\u7406\u4e91\u670d\u52a1\u5668\u670d\u52a1\uff08ECS\uff09\u7684\u6743\u9650 AliyunVPCFullAccess \u7ba1\u7406\u4e13\u6709\u7f51\u7edc\uff08VPC\uff09\u7684\u6743\u9650 AliyunROSFullAccess \u7ba1\u7406\u8d44\u6e90\u7f16\u6392\u670d\u52a1\uff08ROS\uff09\u7684\u6743\u9650 AliyunComputeNestUserFullAccess \u7ba1\u7406\u8ba1\u7b97\u5de2\u670d\u52a1\uff08ComputeNest\uff09\u7684\u7528\u6237\u4fa7\u6743\u9650 AliyunComputeNestSupplierFullAccess \u7ba1\u7406\u8ba1\u7b97\u5de2\u670d\u52a1\uff08ComputeNest\uff09\u7684\u670d\u52a1\u5546\u4fa7\u6743\u9650 AliyunPrivateLinkFullAccess \u7ba1\u7406\u79c1\u7f51\u8fde\u63a5\uff08PrivateLink\uff09\u7684\u6743\u9650","title":"RAM\u8d26\u53f7\u6240\u9700\u6743\u9650"},{"location":"#_5","text":"\u6d4b\u8bd5\u672c\u670d\u52a1\u5728\u8ba1\u7b97\u5de2\u4e0a\u7684\u8d39\u7528\u4e3b\u8981\u6d89\u53ca\uff1a \u6240\u9009vCPU\u4e0e\u5185\u5b58\u89c4\u683c \u7cfb\u7edf\u76d8\u7c7b\u578b\u53ca\u5bb9\u91cf \u516c\u7f51\u5e26\u5bbd \u79c1\u7f51\u8fde\u63a5\u8d39\u7528 \u8ba1\u8d39\u65b9\u5f0f\u5305\u62ec\uff1a \u6309\u91cf\u4ed8\u8d39\uff08\u5c0f\u65f6\uff09 \u5305\u5e74\u5305\u6708 \u76ee\u524d\u63d0\u4f9b\u5982\u4e0b\u5957\u9910\uff1a \u5957\u9910\u540d SLB\u89c4\u683c ECS\u89c4\u683c\u65cf vCPU\u4e0e\u5185\u5b58 \u7cfb\u7edf\u76d8 \u516c\u7f51\u5e26\u5bbd \u4f4e\u914d\u7248 slb.s1.small ecs.c6.large \u5185\u5b58\u578bc6\uff0c2vCPU 4GiB ESSD\u4e91\u76d8 200GiB PL0 \u56fa\u5b9a\u5e26\u5bbd1Mbps \u57fa\u7840\u7248 slb.s1.small ecs.c6.xlarge \u5185\u5b58\u578bc6\uff0c4vCPU 8GiB ESSD\u4e91\u76d8 200GiB PL0 \u56fa\u5b9a\u5e26\u5bbd1Mbps \u9ad8\u914d\u7248 slb.s3.small ecs.c6.2xlarge \u5185\u5b58\u578bc6\uff0c4vCPU 8GiB ESSD\u4e91\u76d8 200GiB PL0 \u56fa\u5b9a\u5e26\u5bbd1Mbps \u9884\u4f30\u8d39\u7528\u5728\u521b\u5efa\u5b9e\u4f8b\u65f6\u53ef\u5b9e\u65f6\u770b\u5230\u3002\u79c1\u7f51\u8fde\u63a5\u53ea\u6709\u5728\u521b\u5efa\u670d\u52a1\u65f6\u5019\u5e76\u5efa\u7acb\u8fde\u63a5\u540e\u624d\u4f1a\u8ba1\u8d39\uff0c\u5177\u4f53\u7684\u8ba1\u8d39\u65b9\u5f0f\u53ef\u4ee5\u53c2\u8003\uff1ahttps://help.aliyun.com/document_detail/198081.html?spm=a2c4g.120462.0.0.5f104bffA7i9WJ","title":"\u670d\u52a1\u5b9e\u4f8b\u8ba1\u8d39\u8bf4\u660e"},{"location":"#_6","text":"","title":"\u90e8\u7f72\u6d41\u7a0b"},{"location":"#_7","text":"\u53c2\u6570\u65cf \u53c2\u6570\u9879 \u8bf4\u660e \u57fa\u7840\u914d\u7f6e \u6570\u636e\u5e93root\u548cadmin\u8d26\u6237\u5bc6\u7801 \u6570\u636e\u5e93root\u548cadmin\u8d26\u6237\u5bc6\u7801\uff0c\u957f\u5ea68-32\u4e2a\u5b57\u7b26\uff0c\u53ef\u5305\u542b\u5927\u5c0f\u5b57\u6bcd\u3001\u6570\u5b57\u53ca\u7279\u6b8a\u7b26\u53f7\uff08\u5305\u542b\uff1a!@#$%^&*-+=_\uff09\u3002 \u7f51\u7edc\u914d\u7f6e \u53ef\u7528\u533a \u9009\u62e9\u53ef\u7528\u533a\uff0c\u8d44\u6e90\u5c06\u5728\u670d\u52a1\u5546\u7684\u8be5\u53ef\u7528\u533a\u521b\u5efa\u3002 \u7f51\u7edc\u8bbe\u7f6e \u4e13\u6709\u7f51\u7edc \u9009\u62e9\u5efa\u7acb\u79c1\u7f51\u8fde\u63a5\u7684VPC\u3002 \u7f51\u7edc\u8bbe\u7f6e \u5b89\u5168\u7ec4 \u9009\u62e9\u5efa\u7acb\u79c1\u7f51\u8fde\u63a5\u7684\u5b89\u5168\u7ec4\u3002 \u7f51\u7edc\u8bbe\u7f6e \u4ea4\u6362\u673a\u548c\u53ef\u7528\u533a \u9009\u62e9\u5efa\u7acb\u79c1\u7f51\u8fde\u63a5\u7684\u53ef\u7528\u533a\u4e0e\u4ea4\u6362\u673a\u3002","title":"\u90e8\u7f72\u53c2\u6570\u8bf4\u660e"},{"location":"#_8","text":"\u90e8\u7f72\u94fe\u63a5 \u5355\u51fb\u90e8\u7f72\u94fe\u63a5\uff0c\u8fdb\u5165\u670d\u52a1\u5b9e\u4f8b\u90e8\u7f72\u754c\u9762\uff0c\u6839\u636e\u754c\u9762\u63d0\u793a\uff0c\u586b\u5199\u53c2\u6570\u5b8c\u6210\u90e8\u7f72\u3002 \u7f51\u7edc\u8bbe\u7f6e\u90e8\u5206\u5982\u679c\u586b\u5199\u7f51\u7edc\u4fe1\u606f\uff0c\u79c1\u7f51\u8fde\u63a5\u7684\u7ec8\u7aef\u8282\u70b9\u5c06\u5728\u8be5\u53ef\u7528\u533a\u521b\u5efa\u3002 \u6ce8\uff1a\u7531\u4e8e\u672c\u670d\u52a1\u5f00\u542f\u4e86\u7f51\u7edc\u53d8\u914d\u529f\u80fd\uff0c\u82e5\u6b64\u5904\u4e0d\u5f00\u542f\u79c1\u7f51\u8fde\u63a5\uff0c\u4e5f\u53ef\u901a\u8fc7\u53d8\u914d\u529f\u80fd\u5f00\u542f\u3002\u8be6\u60c5\u89c1\u53d8\u914d\u6d41\u7a0b-\u53d8\u914d\u79c1\u7f51\u8fde\u63a5\u3002 2. \u53c2\u6570\u586b\u5199\u5b8c\u6210\u540e\u70b9\u51fb \u4e0b\u4e00\u6b65\uff1a\u786e\u8ba4\u8ba2\u5355 \u786e\u8ba4\u53c2\u6570\u3002 3. \u786e\u8ba4\u8ba2\u5355\u5b8c\u6210\u540e\u540c\u610f\u670d\u52a1\u534f\u8bae\u5e76\u70b9\u51fb \u7acb\u5373\u521b\u5efa \uff0c\u968f\u540e\u8fdb\u5165\u90e8\u7f72\u9636\u6bb5\u3002 4. \u7b49\u5f85\u90e8\u7f72\u5b8c\u6210\u540e\u5c31\u53ef\u4ee5\u5f00\u59cb\u4f7f\u7528\u670d\u52a1\u3002 5. \u4f7f\u7528\u670d\u52a1 1. \u672c\u670d\u52a1\u652f\u6301\u79c1\u7f51\u8bbf\u95ee\uff0c\u79df\u6237\u53ef\u4ee5\u901a\u8fc7PrivateLink\u5b9e\u73b0\u79c1\u7f51\u8bbf\u95ee\uff08 \u79c1\u7f51\u8bbf\u95ee\u5e2e\u52a9\u6587\u6863 \uff09\uff0c \u79df\u6237\u79c1\u7f51\u8bbf\u95ee\u6d41\u7a0b\uff1a 1. \u5728\u670d\u52a1\u5b9e\u4f8b\u7684\u865a\u62df\u4e92\u8054\u7f51\u9875\u7b7e\u4e2d\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\uff0c\u8fde\u63a5\u65f6\u53ef\u4ee5\u901a\u8fc7\u81ea\u5b9a\u4e49\u57df\u540d\uff08\u5982\u679c\u5728\u521b\u5efa\u670d\u52a1\u5b9e\u4f8b\u65f6\u52fe\u9009\u4e86\u7684\u8bdd\uff09\u3001IP\u5730\u5740\u6216\u8005\u53ef\u7528\u533a\u57df\u540d\u8fdb\u884c\u8bbf\u95ee\u3002 2. \u5728\u5bf9\u5e94\u7684vsw\u4e2d\u521b\u5efaECS\uff0c\u521b\u5efa\u597d\u540e\u5b89\u88c5mysql\u5ba2\u6237\u7aef\u3002 yum install mysql or apt install mysql-client 3. \u5728\u8be5ECS\u4e2d\u8fde\u63a5MySQL\uff0c\u4e0b\u9762\u5c55\u793a\u5206\u522b\u7528\u81ea\u5b9a\u4e49\u57df\u540d\u3001IP\u4e0e\u53ef\u7528\u533a\u57df\u540d\u8fdb\u884c\u8fde\u63a5\uff1a 1. \u81ea\u5b9a\u4e49\u57df\u540d\u65b9\u5f0f\u8bbf\u95ee\uff1a ![\u81ea\u5b9a\u4e49\u57df\u540d\u8bbf\u95ee.png](\u81ea\u5b9a\u4e49\u57df\u540d\u8bbf\u95ee.png) 2. \u901a\u8fc7IP\u8bbf\u95ee\uff1a ![\u901a\u8fc7ip\u8bbf\u95ee.png](\u901a\u8fc7ip\u8bbf\u95ee.png) 3. \u901a\u8fc7\u53ef\u7528\u533a\u57df\u540d\u8bbf\u95ee\uff1a ![\u901a\u8fc7\u53ef\u7528\u533a\u57df\u540d\u8bbf\u95ee.png](\u901a\u8fc7\u53ef\u7528\u533a\u57df\u540d\u8bbf\u95ee.png) \u672c\u670d\u52a1\u652f\u6301\u4fee\u6539\u670d\u52a1\u914d\u7f6e\u53c2\u6570\u3002 \u8bf7\u6ce8\u610f\uff0c\u4fee\u6539\u53c2\u6570\u4f1a\u5f15\u8d77\u670d\u52a1\u91cd\u542f \u3002\u4fee\u6539\u670d\u52a1\u53c2\u6570\u7684\u6d41\u7a0b\uff1a \u8fdb\u5165\u670d\u52a1\u5b9e\u4f8b\u8be6\u60c5\uff1a \u70b9\u51fb \u4fee\u6539\u53c2\u6570 \uff0c\u7f16\u8f91\u4fee\u6539\u503c\uff0c\u5b8c\u6210\u540e\u70b9\u51fb \u4fdd\u5b58 \u3002 \u70b9\u51fb\u4fdd\u5b58\u540e\uff0c\u670d\u52a1\u5b9e\u4f8b\u4f1a\u8fdb\u5165\u53c2\u6570\u66f4\u65b0\u6d41\u7a0b\uff0c\u5927\u81f4\u9700\u89811~2\u5206\u949f\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u3002 \u53c2\u6570\u66f4\u65b0\u6d41\u7a0b\u5b8c\u6210\u540e\uff0c\u53c2\u6570\u751f\u6548\u3002","title":"\u90e8\u7f72\u6b65\u9aa4"},{"location":"#_9","text":"","title":"\u53d8\u914d\u6d41\u7a0b"},{"location":"#_10","text":"\u672c\u670d\u52a1\u9ed8\u8ba4\u5f00\u542f\u652f\u6301\u53d8\u914d\u79c1\u7f51\u8fde\u63a5\u3001\u652f\u6301\u6570\u636e\u76d8\u6269\u5bb9\u3002 \u79c1\u7f51\u8fde\u63a5\u53d8\u914d\uff1a\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u53d8\u914d\u5f00\u542f/\u5173\u95ed/\u65b0\u589e/\u5220\u9664\u79c1\u7f51\u8fde\u63a5\uff1b \u6570\u636e\u76d8\u6269\u5bb9\uff1a\u7528\u6237\u53ef\u901a\u8fc7\u53d8\u914d\u6269\u5bb9\u6570\u636e\u76d8\u5bb9\u91cf\u3002","title":"\u8bf4\u660e"},{"location":"#_11","text":"\u524d\u63d0\u8bf4\u660e\uff1a\u672c\u53d8\u914d\u793a\u4f8b\u4e3a\u7528\u6237\u5728\u521b\u5efa\u670d\u52a1\u5b9e\u4f8b\u65f6\u672a\u5f00\u542f\u79c1\u7f51\u8fde\u63a5\uff0c\u5728\u670d\u52a1\u5b9e\u4f8b\u521b\u5efa\u5b8c\u6210\u540e\u9700\u8981\u5f00\u542f\u3002 \u7528\u6237\u5df2\u6709\u670d\u52a1\u5b9e\u4f8b\u672a\u5f00\u542f\u79c1\u7f51\u8fde\u63a5\u3002 \u70b9\u51fb\u53f3\u4e0a\u89d2 \u4fee\u6539\u914d\u7f6e \u8fdb\u5165\u53d8\u914d\u670d\u52a1\u5b9e\u4f8b\u9875\u9762\uff0c\u9009\u62e9 \u7f51\u7edc\u53d8\u914d \u3002 \u70b9\u51fb \u4e0b\u4e00\u6b65 \u8fdb\u5165 \u8bbe\u7f6e\u4fee\u6539\u53c2\u6570 \uff0c\u6dfb\u52a0\u79c1\u7f51\u8fde\u63a5\u53c2\u6570\u3002 \u6ce8\u610f\uff1a\u8bf7\u786e\u4fdd\u586b\u5165\u7684\u5b89\u5168\u7ec4\u5165\u65b9\u5411\u5f00\u542f3306\u7aef\u53e3\uff0c\u5426\u5219\u79c1\u7f51\u8bbf\u95ee\u5c06\u65e0\u6cd5\u8fde\u63a5\u3002 \u70b9\u51fb \u4e0b\u4e00\u6b65 \u9884\u89c8\u53d8\u914d\u5185\u5bb9\u3002 \u70b9\u51fb \u786e\u5b9a \u5f00\u59cb\u6267\u884c\u53d8\u914d\uff0c\u7b49\u5f85\u53d8\u914d\u5b8c\u6210\u3002 \u53d8\u914d\u5b8c\u6210\uff0c\u670d\u52a1\u5b9e\u4f8b\u72b6\u6001\u53d8\u4e3a\u5df2\u90e8\u7f72\uff0c\u8fdb\u5165\u7f51\u7edc\u914d\u7f6e\u53ef\u89c1\u65b0\u589e\u7684\u79c1\u7f51\u8fde\u63a5\u4fe1\u606f\u3002\u4e4b\u540e\u4fbf\u53ef\u901a\u8fc7 \u90e8\u7f72\u6d41\u7a0b \u6b65\u9aa45\u6240\u8ff0\u5b8c\u6210\u8fde\u63a5\u3002 \u540e\u7eed\u82e5\u9700\u8981\u5173\u95ed/\u65b0\u589e/\u5220\u9664\u79c1\u7f51\u8bbf\u95ee\u7b49\u5176\u4ed6\u64cd\u4f5c\uff0c\u540c\u6837\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u914d\u7f6e-\u7f51\u7edc\u53d8\u914d\u5b8c\u6210\u3002","title":"\u53d8\u914d\u79c1\u7f51\u8fde\u63a5\u6b65\u9aa4"},{"location":"#_12","text":"\u524d\u63d0\u8bf4\u660e \u672c\u53d8\u914d\u793a\u4f8b\u4e3a\u7528\u6237\u6269\u5bb9\u78c1\u76d8\u5bb9\u91cf\uff0c\u670d\u52a1\u6a21\u677f\u4e2d\u5c06\"\u6269\u5bb9\u78c1\u76d8\u5bb9\u91cf\"\u53d8\u914d\u7c7b\u578b\u8bbe\u7f6e\u4e3a\u5347\u914d\uff0c\u5373\u4ec5\u80fd\u6269\u5bb9\uff1b \u4e3a\u4f7f\u78c1\u76d8\u53ef\u53d8\u914d\u4e0e\u811a\u672c\u53ef\u6267\u884c\uff0c\u670d\u52a1\u6a21\u677f\u4e2d\u8d44\u6e90EcsInstanceGroup\u53c2\u6570UpdatePolicy\u9700\u8bbe\u7f6e\u4e3aForAllInstances\uff0c\u8d44\u6e90RunCommand\u53c2\u6570Sync\u9700\u8bbe\u7f6e\u4e3atrue\u3002 \u4ee5\u4e0a\u53c2\u6570\u6a21\u677f\u4e2d\u5747\u5df2\u914d\u7f6e\u597d\uff0c\u6b64\u5904\u4ec5\u544a\u77e5\u3002 \u70b9\u51fb\u53f3\u4e0a\u89d2 \u4fee\u6539\u914d\u7f6e \u8fdb\u5165\u53d8\u914d\u670d\u52a1\u5b9e\u4f8b\u9875\u9762\uff0c\u9009\u62e9 \u78c1\u76d8\u5bb9\u91cf\u6269\u5bb9 \u3002 \u70b9\u51fb \u4e0b\u4e00\u6b65 \u8fdb\u5165 \u8bbe\u7f6e\u4fee\u6539\u53c2\u6570 \uff0c\u5c06\u539f\u6709\u78c1\u76d8\u5bb9\u91cf\u4ece200GB\u4fee\u6539\u4e3a400GB\u3002 \u70b9\u51fb \u4e0b\u4e00\u6b65 \u9884\u89c8\u53d8\u914d\u53c2\u6570\u3002 \u70b9\u51fb\u786e\u5b9a\u5f00\u59cb\u6267\u884c\u53d8\u914d\uff0c\u7b49\u5f85\u53d8\u914d\u5b8c\u6210\u3002 \u53d8\u914d\u5b8c\u6210\uff0c\u670d\u52a1\u5b9e\u4f8b\u72b6\u6001\u53d8\u4e3a\u5df2\u90e8\u7f72\u3002 \u67e5\u770b\u7ed3\u679c\uff1a\u8fdb\u5165\u670d\u52a1\u7aefECS \u901a\u8fc7\u547d\u4ee4 df -h \u67e5\u770b\uff0c\u78c1\u76d8\u5bb9\u91cf\u5df2\u4fee\u6539: \u53d8\u914d\u524d\uff1a \u53d8\u914d\u540e\uff1a","title":"\u78c1\u76d8\u5bb9\u91cf\u6269\u5bb9\u6b65\u9aa4"},{"location":"#_13","text":"\u672c\u6587\u63d0\u524d\u5c06MySQL\u793e\u533a\u7248\u5b89\u88c5\u5305\u5b58\u653e\u5230\u8be5Github Repo\u4e2d\uff0c\u6784\u5efa\u670d\u52a1\u8fc7\u7a0b\u4e2d\u4f1a\u5c06\u8be5\u5b89\u88c5\u5305\u53d1\u5e03\u4e3a\u8ba1\u7b97\u5de2\u90e8\u7f72\u7269\uff0c\u5e76\u5728ROS\u6a21\u677f\u5199\u5165\u5b89\u88c5\u6307\u4ee4\uff0cROS\u6a21\u677f\u5f15\u64ce\u5728\u6267\u884c\u65f6\u4fbf\u4f1a\u81ea\u52a8\u6267\u884c\u5b89\u88c5\u4e86\u3002 wget '{{ computenest::file::MySQL }}' -O mysql-community-release-el6-5.noarch.rpm rpm -ivh mysql-community-release-el6-5.noarch.rpm yum repolist all | grep mysql yum install mysql-community-server -y {{ computenest::file::MySQL }} \u4e3a\u5360\u4f4d\u7b26\uff0c\u4f1a\u7531\u8ba1\u7b97\u5de2\u670d\u52a1\u66ff\u6362\u6210\u6587\u4ef6\u90e8\u7f72\u7269MySQL\u7684http\u4e0b\u8f7d\u5730\u5740\u3002 \u6587\u4ef6\u8bf4\u660e \u6587\u4ef6\u8def\u5f84 \u8bf4\u660e config.yaml \u6784\u5efa\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u670d\u52a1\u6784\u5efa\u8fc7\u7a0b\u4e2d\u4f1a\u4f7f\u7528\u8ba1\u7b97\u5de2\u547d\u4ee4\u884c\u5de5\u5177 computenest-cli \uff0ccomputenest-cli\u4f1a\u57fa\u4e8e\u8be5\u914d\u7f6e\u6587\u4ef6\u6784\u5efa\u670d\u52a1\u3002 parameters.yaml \u672c\u670d\u52a1\u4e3a\u6258\u7ba1\u7248\u5355\u79df\uff0c\u4f7f\u7528\u8be5\u6587\u4ef6\u6e32\u67d3\u670d\u52a1\u5546\u9700\u8981\u914d\u7f6e\u7684\u7f51\u7edc\u53c2\u6570\uff0c\u5305\u62ecVpcId\uff0cVSwitch\u7b49\u3002 artifact/mysql-community-release-el6-5.noarch.rpm MySQL\u793e\u533a\u7248\u5b89\u88c5\u5305\uff0c\u6784\u5efa\u8fc7\u7a0b\u4f1a\u5c06\u8be5\u5305\u53d1\u5e03\u4e3a\u8ba1\u7b97\u5de2\u90e8\u7f72\u7269\u3002 icons/service_logo.jpg \u6784\u5efa\u670d\u52a1\u9ed8\u8ba4\u7684\u56fe\u6807\u3002 templates/parameters.yaml \u672c\u670d\u52a1\u4e3a\u6258\u7ba1\u7248\u5355\u79df\u670d\u52a1\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u7528\u6237\u586b\u5199\u4e00\u90e8\u5206\u53c2\u6570\uff0c\u901a\u8fc7\u8be5\u6587\u4ef6\u6307\u5b9a\u7528\u6237\u6240\u586b\u53c2\u6570\u3002 templates/template.yaml ROS\u6a21\u677f\u6587\u4ef6\uff0cROS\u6a21\u677f\u5f15\u64ce\u6839\u636e\u8be5\u6a21\u677f\u80fd\u591f\u81ea\u52a8\u521b\u5efa\u51fa\u6240\u6709\u7684\u8d44\u6e90\u3002 templates/template.yaml\u4e3b\u8981\u7531\u4e09\u90e8\u5206\u7ec4\u6210 Parameters\u5b9a\u4e49\u9700\u8981\u7528\u6237\u586b\u5199\u7684\u53c2\u6570\uff0c\u5305\u62ec\u4ed8\u8d39\u7c7b\u578b\uff0c\u5b9e\u4f8b\u89c4\u683c\u548c\u5b9e\u4f8b\u5bc6\u7801\u53ef\u7528\u533a\u53c2\u6570\u3002 ZoneId: Type: String AssociationProperty: ALIYUN::ECS::Instance:ZoneId Label: en: VSwitch Available Zone zh-cn: \u53ef\u7528\u533a # \u6570\u636e\u5e93root\u8d26\u6237\u5bc6\u7801 Password: # \u67e5\u8be2\u8be5\u53c2\u6570\u65f6\u53ea\u8f93\u51fa\u661f\u53f7\uff08*\uff09 NoEcho: true Type: String Description: en: 'Database root account passwor, 8-32 characters, including uppercase and lowercase letters, numbers and special symbols (including: !@#$%^&*-+=_).' zh-cn: \u6570\u636e\u5e93root\u8d26\u6237\u5bc6\u7801\uff0c\u957f\u5ea68-32\u4e2a\u5b57\u7b26\uff0c\u53ef\u5305\u542b\u5927\u5c0f\u5b57\u6bcd\u3001\u6570\u5b57\u53ca\u7279\u6b8a\u7b26\u53f7\uff08\u5305\u542b\uff1a!@#$%^&*-+=_\uff09\u3002 Label: en: Root Account Password zh-cn: \u6570\u636e\u5e93root\u8d26\u6237\u5bc6\u7801 ConstraintDescription: en: '8-32 characters, including uppercase and lowercase letters, numbers and special symbols (including: !@#$%^&*-+=_).' zh-cn: 8-32\u4e2a\u5b57\u7b26\uff0c\u53ef\u5305\u542b\u5927\u5c0f\u5b57\u6bcd\u3001\u6570\u5b57\u53ca\u7279\u6b8a\u7b26\u53f7\uff08\u5305\u542b\uff1a!@#$%^&*-+=_\uff09\u3002 MinLength: '8' MaxLength: '32' AssociationProperty: ALIYUN::ECS::Instance::Password # \u4e13\u6709\u7f51\u7edcVPC\u5b9e\u4f8bID VpcId: AssociationProperty: ALIYUN::ECS::VPC::VPCId Type: String Label: en: VPC ID zh-cn: \u4e13\u6709\u7f51\u7edcVPC\u5b9e\u4f8bID # \u4ea4\u6362\u673a\u5b9e\u4f8bID VSwitchId: AssociationProperty: ALIYUN::ECS::VSwitch::VSwitchId AssociationPropertyMetadata: VpcId: ${VpcId} ZoneId: ${ZoneId} Type: String Label: en: VSwitch ID zh-cn: \u4ea4\u6362\u673a\u5b9e\u4f8bID # \u6570\u636e\u76d8\u5927\u5c0f DataDiskSize: Description: zh-cn: ECS\u5b9e\u4f8b\u6570\u636e\u76d8\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aGiB\u3002\u53d6\u503c\u8303\u56f4\uff1a100~32768 en: 'ECS Instance disk size, range of values: 100-32768, units: GB' Default: 200 MaxValue: 32768 MinValue: 100 Label: zh-cn: \u6570\u636e\u76d8\u7a7a\u95f4 en: Data Disk Space Type: Number # Ecs\u5b9e\u4f8b\u7c7b\u578b EcsInstanceType: Type: String Label: en: Instance Type zh-cn: Ecs\u5b9e\u4f8b\u7c7b\u578b AssociationProperty: ALIYUN::ECS::Instance::InstanceType AllowedValues: - ecs.c6.large - ecs.c6.xlarge - ecs.c6.2xlarge - ecs.c6.4xlarge SlbInstanceType: Type: String Label: en: Instance Type zh-cn: Slb\u5b9e\u4f8b\u7c7b\u578b AssociationProperty: ALIYUN::Slb::LoadBalance::LoadBalancerSpec AllowedValues: - slb.s1.small - slb.s3.small Resources\u5b9a\u4e49\u9700\u8981\u5f00\u7684\u8d44\u6e90\uff0c\u5305\u62ec\u65b0\u5f00\u7684Vpc,\u3001VSwitch\u3001ECS\u3001Slb\u5b9e\u4f8b\u3001\u79c1\u7f51\u8fde\u63a5\u3002 EcsSecurityGroup: Type: 'ALIYUN::ECS::SecurityGroup' Properties: VpcId: Ref: VpcId SecurityGroupIngress: - Priority: 1 PortRange: 3306/3306 NicType: internet SourceCidrIp: 0.0.0.0/0 IpProtocol: tcp # Ecs\u5b9e\u4f8b EcsInstanceGroup: Type: ALIYUN::ECS::InstanceGroup Properties: # I/O\u4f18\u5316\u5b9e\u4f8b IoOptimized: optimized ZoneId: Ref: ZoneId DiskMappings: - Category: cloud_essd Device: /dev/xvdb Size: Ref: DataDiskSize SystemDiskSize: 40 # \u4ed8\u8d39\u65b9\u5f0f\uff1a\u6309\u91cf\u4ed8\u8d39 InstanceChargeType: PostPaid MaxAmount: 1 # \u7cfb\u7edf\u76d8\u7c7b\u578b\uff1acloud_essd SystemDiskCategory: cloud_essd # \u5b9e\u4f8b\u540d\u79f0 InstanceName: Ref: ALIYUN::StackName VpcId: Ref: VpcId SecurityGroupId: Ref: EcsSecurityGroup VSwitchId: Ref: VSwitchId # \u6307\u5b9aCentOS 7.9\u955c\u50cf\uff0c\u5982\u679c\u4fee\u6539\u955c\u50cf\uff0cUserData\u811a\u672c\u9700\u8981\u8fdb\u884c\u9002\u914d ImageId: \"centos_7_9_x64_20G_alibase_20220727.vhd\" InstanceType: Ref: EcsInstanceType # \u4e3b\u673a\u540d HostName: Ref: ALIYUN::StackName # Ecs\u767b\u5f55\u5bc6\u7801 Password: Ref: Password # \u662f\u5426\u4e3a\u5b9e\u4f8b\u5206\u914d\u516c\u7f51IP AllocatePublicIP: true InternetMaxBandwidthOut: 1 # ECS\u6267\u884c\u811a\u672c RunCommand: Type: ALIYUN::ECS::RunCommand Properties: CommandContent: Fn::Sub: - | #!/bin/sh FLAG_FILE=\"/root/.disk_initialized\" PARTITION=/dev/vdb1 MOUNT_POINT=/data1 initialize_disk() { # \u521d\u59cb\u5316\u6570\u636e\u76d8\uff0c\u5bf9\u6570\u636e\u76d8\u5206\u533a cat >> /root/InitDataDisk.sh << EOF #!/bin/bash echo \"p n p w \" | fdisk -u /dev/vdb EOF /bin/bash /root/InitDataDisk.sh rm -f /root/InitDataDisk.sh rm -f InitDataDisk.sh # \u5728\u65b0\u5206\u533a\u4e0a\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf mkfs.ext4 /dev/vdb1 # \u521b\u5efa\u76ee\u5f55\uff0cMySQL\u5c06\u5b89\u88c5\u5728\u8be5\u76ee\u5f55\u4e0b mkdir /data1 # \u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf mount /dev/vdb1 /data1 # \u5411 /etc/fstab \u5199\u5165\u65b0\u5206\u533a\u4fe1\u606f echo /dev/vdb1 /data1 ext4 defaults,nodelalloc,noatime 0 2 >> /etc/fstab } install_mysql() { # \u5b89\u88c5\u793e\u533a\u7248MySQL cd /data1/ wget '{{ computenest::file::MySQL }}' -O mysql-community-release-el6-5.noarch.rpm rpm -ivh mysql-community-release-el6-5.noarch.rpm yum repolist all | grep mysql yum install mysql-community-server -y # \u542f\u52a8MySQL\u670d\u52a1 service mysqld start } configure_mysql() { # \u4ee5\u8d85\u7ea7\u7528\u6237\u8eab\u4efd\u767b\u5165\uff0c\u521b\u5efaadmin\u7528\u6237\uff0c\u5e76\u5141\u8bb8admin\u7528\u6237\u4ee5Password\u4e3a\u5bc6\u7801\u8fdc\u7a0b\u767b\u5f55 mysqladmin -u root password '${Password}' echo \"create database test character set utf8 collate utf8_bin;\" > ./test.sql echo \"CREATE USER 'admin'@'%' IDENTIFIED BY '${Password}';\" >> ./test.sql echo \"GRANT ALL PRIVILEGES ON *.* TO 'admin'@'%' WITH GRANT OPTION;\" >> ./test.sql mysql -u root -p'${Password}' < ./test.sql } move_mysql_data() { # \u5c06MySQL\u7684\u914d\u7f6e\u548c\u6570\u636e\u8def\u5f84\u79fb\u52a8\u5230\u6570\u636e\u76d8\u4e0a systemctl stop mysqld rsync -av /var/lib/mysql /data1 # \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 sed -i 's/\\/var\\/lib/\\/data1/g' /etc/my.cnf echo -e '\\n' >> /etc/my.cnf echo '[client]' >> /etc/my.cnf echo 'port=3306' >> /etc/my.cnf echo 'socket=/data1/mysql/mysql.sock' >> /etc/my.cnf # \u91cd\u542fMySQL systemctl start mysqld } expand_partition() { # \u4f7f\u7528 growpart \u6269\u5c55\u5206\u533a echo \"Expanding partition...\" if ! growpart /dev/vdb 1; then echo \"Failed to expand partition\" exit 1 fi # \u901a\u77e5\u7cfb\u7edf\u5206\u533a\u7684\u66f4\u6539 partprobe $PARTITION # \u4f7f\u7528 e2fsck \u68c0\u67e5\u6587\u4ef6\u7cfb\u7edf echo \"Checking filesystem...\" e2fsck -f -y $PARTITION # \u6269\u5c55\u6587\u4ef6\u7cfb\u7edf echo \"Resizing filesystem...\" resize2fs $PARTITION } if [ ! -f \"$FLAG_FILE\" ]; then # \u9996\u6b21\u521b\u5efaECS\u65f6\u6267\u884c # \u786e\u4fdd\u7f51\u7edc\u5c31\u7eea sleep 15 initialize_disk install_mysql configure_mysql move_mysql_data # \u5f53\u521d\u59cb\u5316\u5b8c\u6210\u540e\uff0c\u521b\u5efa\u4e00\u4e2a\u6807\u5fd7\u6587\u4ef6 touch \"$FLAG_FILE\" echo \"Initialization complete. Flag file created.\" # \u6267\u884c\u6210\u529f\u56de\u8c03WaitCondition\u7ed3\u675fWaitCondition\u7684\u7b49\u5f85 ${CurlCli} -d \"{\\\"Data\\\" : \\\"SUCCESS\\\", \\\"Status\\\" : \\\"SUCCESS\\\"}\" else # \u6269\u5bb9\u6570\u636e\u76d8\u65f6\u6267\u884c # \u505c\u6b62MySQL\u670d\u52a1 systemctl stop mysqld # \u68c0\u67e5\u5e76\u786e\u4fdd\u5206\u533a\u672a\u88ab\u6302\u8f7d if mountpoint -q $MOUNT_POINT; then umount $MOUNT_POINT fi expand_partition # \u91cd\u65b0\u6302\u8f7d\u5206\u533a echo \"Remounting partition...\" mount $PARTITION $MOUNT_POINT # \u542f\u52a8MySQL\u670d\u52a1 systemctl start mysqld fi # \u83b7\u53d6\u5230WaitConditionHandle\u7684\u5730\u5740\u653e\u5230 ${CurlCli}\u53d8\u91cf\u91cc - CurlCli: Fn::GetAtt: - WaitConditionHandle - CurlCli # \u6570\u636e\u5e93root\u8d26\u6237\u5bc6\u7801 Password: Ref: Password Type: RunShellScript Timeout: 900 Sync: true InstanceIds: - Ref: EcsInstanceGroup Slb: Type: ALIYUN::SLB::LoadBalancer Properties: LoadBalancerName: Fn::Join: - '-' - - mysql - Ref: ALIYUN::StackName VpcId: Ref: VpcId VSwitchId: Ref: VSwitchId PayType: PayOnDemand AddressType: intranet LoadBalancerSpec: Ref: SlbInstanceType SupportPrivateLink: true SlbBackendServerAttachment: DependsOn: - EcsInstanceGroup Type: ALIYUN::SLB::BackendServerAttachment Properties: BackendServerList: Fn::GetAtt: - EcsInstanceGroup - InstanceIds LoadBalancerId: Ref: Slb BackendServerWeightList: - 100 - 0 SlbListener: DependsOn: Slb Type: ALIYUN::SLB::Listener Properties: Persistence: CookieTimeout: 60 StickySession: 'on' PersistenceTimeout: 180 XForwardedFor: 'off' StickySessionType: insert ListenerPort: 3306 Bandwidth: -1 HealthCheck: HttpCode: http_2xx,http_3xx,http_4xx,http_5xx HealthCheckType: tcp UnhealthyThreshold: 3 Timeout: 5 HealthyThreshold: 3 Port: 3306 URI: / Interval: 2 LoadBalancerId: Ref: Slb BackendServerPort: 3306 Protocol: tcp VpcEndpointService: DependsOn: Slb Type: ALIYUN::PrivateLink::VpcEndpointService Properties: ServiceDescription: isv service Resource: - ZoneId: Ref: ZoneId ResourceId: Ref: Slb ResourceType: slb AutoAcceptEnabled: true Outputs\u5b9a\u4e49\u9700\u8981\u6700\u7ec8\u5728\u8ba1\u7b97\u5de2\u6982\u89c8\u9875\u4e2d\u5bf9\u7528\u6237\u5c55\u793a\u7684\u8f93\u51fa Outputs: EndpointServiceId: Description: en: EndpointService Id zh-cn: \u7ec8\u7aef\u8282\u70b9\u670d\u52a1Id Value: Fn::GetAtt: - VpcEndpointService - ServiceId Endpoint: Value: Fn::Join: - '' - - Ref: ALIYUN::StackName - .mysql.com MysqlUserName: Description: en: MySQL User Name zh-cn: MySQL\u767b\u5f55\u7528\u6237\u540d Value: admin","title":"\u670d\u52a1\u8be6\u7ec6\u8bf4\u660e"},{"location":"#_14","text":"\u521b\u5efa\u4ee3\u8fd0\u7ef4\u670d\u52a1\u5b8c\u6210\u5b9e\u4f8b\u8fd0\u7ef4 \u521b\u5efa\u5305\u542b\u53d8\u914d\u529f\u80fd\u7684\u670d\u52a1 \u521b\u5efa\u5305\u542b\u670d\u52a1\u5347\u7ea7\u529f\u80fd\u7684\u670d\u52a1","title":"\u670d\u52a1\u914d\u7f6e"},{"location":"#_15","text":"\u81ea\u5b9a\u4e49\u670d\u52a1\u67b6\u6784\u56fe \u670d\u52a1\u6587\u6863\u4e0a\u7ebf\u6d41\u7a0b \u5c06\u670d\u52a1\u4e0a\u67b6\u4e91\u5e02\u573a\u5e76\u4e0a\u5230\u4e91\u5e02\u573a\u552e\u5356","title":"\u670d\u52a1\u4ea4\u4ed8"}]}